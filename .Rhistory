getwd()
library(ade4)
data(olympic)
read.dataframe(olympic)
read.table(olympic)
read.table("olympic")
attach(olympic)
dudi.pca()
library(adegenet)
obj1 <- read.structure("/Users/Clive/Dropbox/Colp R/Colp_6-loci.str")
obj1[1:5]
obj1
print(obj1)
summary(obj1)
X <- scaleGen(obj1, missing="mean")
summary(X)
print(X)
dim(X)
X[1:5]
X[1:5,1:5]
X[1:65,1:5]
X[1:5,1:65]
pca1 <- dudi.pca(X, cent=FALSE, scale=FALSE, scannf=FALSE, nf=5)
barplot(pca1$eig[1:50], main="PCA eigenvalues", col=heat.colors(50))
s.class(pca1$li, pop(obj1),xax=1,yax=2,col=transp(col,.6), axesell=FALSE, cstar=0, cpoint=3, grid=FALSE)
s.class(pca1$li, pop(obj1),xax=1,yax=2, axesell=FALSE, cstar=0, cpoint=3, grid=FALSE)
add.scatter.eig(pca1$eig[1:20], 3,1,2)
s.class(pca1$li, pop(obj1),xax=1,yax=2,col=transp(col,.6), axesell=FALSE, cstar=0, cpoint=3, grid=FALSE)
s.class(pca1$li, pop(obj1),xax=1,yax=2,col=transp("col",.6), axesell=FALSE, cstar=0, cpoint=3, grid=FALSE)
s.class(pca1$li, pop(obj1),xax=1,yax=2,col=transp(), axesell=FALSE, cstar=0, cpoint=3, grid=FALSE)
s.class(pca1$li, pop(obj1),xax=1,yax=2,col=transp, axesell=FALSE, cstar=0, cpoint=3, grid=FALSE)
s.class(pca1$li, pop(obj1),xax=1,yax=2,col=transp(col,.6), axesell=FALSE, cstar=0, cpoint=3, grid=FALSE)
s.class(pca1$li, pop(obj1),xax=1,yax=2, axesell=FALSE, cstar=0, cpoint=3, grid=FALSE)
add.scatter.eig(pca1$eig[1:20], 3,1,2)
s.class(pca1$li, pop(obj1),xax=1,yax=2, axesell=FALSE, cstar=0, cpoint=2, grid=FALSE)
s.class(pca1$li, pop(obj1),xax=1,yax=2, axesell=FALSE, cstar=1, cpoint=2, grid=FALSE)
s.class(pca1$li, pop(obj1),xax=1,yax=2, axesell=FALSE, cstar=0, cpoint=2, grid=FALSE)
colorplot(pca1$li, pca1$li, transp=TRUE, cex=3, xlab="PC 1", ylab="PC 2")
colorplot(pca1$li, pca1$li, transp=TRUE, cex=5, xlab="PC 1", ylab="PC 2")
colorplot(pca1$li, pca1$li, transp=TRUE, cex=3, xlab="PC 1", ylab="PC 2")
X$tab[1:5]
X$tab[10:18,1:10]
X[1:5]
summary(X)
X$all.names[[3]]
X@all.names[[3]]
X@tab[[3]]
obj1$tab[1:5]
obj1$tab[1:101, 1:65]
X <- scaleGen(microbov, missing="mean")
library(adegenet)
obj1 <- read.structure("/Users/Tharsis/Dropbox/Colp R/Colp_6-loci_locale.str")
s.class(pca1$li, pop(obj1),xax=1,yax=2,col=transp(col,.6), axesell=FALSE, cstar=0, cpoint=3, grid=TRUE)
add.scatter.eig(pca1$eig[1:20], 3,1,2)
write.table(pca1$li, "/Users/Clive/Dropbox/Colp R/Colp_6-loci.csv", sep=",")
library(adegenet)
library(ade4)
obj1 <- read.structure("/Users/Tharsis/Dropbox/Colp R/Colp_6-loci_locale.str")
s.class(pca1$li, pop(obj1),xax=1,yax=2,col=transp(col,.6), axesell=FALSE, cstar=0, cpoint=3, grid=TRUE)
add.scatter.eig(pca1$eig[1:20], 3,1,2)
write.table(pca1$li, "/Users/Clive/Dropbox/Colp R/Colp_6-loci.csv", sep=",")
library(ggplot2)
a <- read.csv("/Users/Tharsis/Dropbox/Colp R/Colp_6-loci.csv", header=TRUE)
ggplot(a, aes(a$Axis1, a$Axis2, label= a$ID, color=(a$sp))) + geom_text(size=3, alpha=.8, cex=4, position="jitter") + theme(panel.background = element_blank(), panel.grid.major = element_blank(), panel.grid.minor=element_blank(), axis.line = element_line(size = .3), legend.position="none") + stat_ellipse(level=.95, linetype=1) + labs(x="PCA1", y="PCA2", title="PCA of C. regis (blue) and C. hubbsi (red) in northern Gulf")
ggplot(a, aes(a$Axis1, a$Axis3, label= a$ID, color=(a$sp))) + geom_text(size=3, alpha=.8, cex=4, position="jitter") + theme(panel.background = element_blank(), panel.grid.major = element_blank(), panel.grid.minor=element_blank(), axis.line = element_line(size = .3), legend.position="none") + stat_ellipse(level=.95, linetype=1) + labs(x="PCA1", y="PCA3", title="PCA of C. regis (blue) and C. hubbsi (red) in northern Gulf")
ggplot(a, aes(a$Axis1, a$Axis4, label= a$ID, color=(a$sp))) + geom_text(size=3, alpha=.8, cex=4, position="jitter") + theme(panel.background = element_blank(), panel.grid.major = element_blank(), panel.grid.minor=element_blank(), axis.line = element_line(size = .3), legend.position="none") + stat_ellipse(level=.95, linetype=1) + labs(x="PCA1", y="PCA4", title="PCA of C. regis (blue) and C. hubbsi (red) in northern Gulf")
#Greer's data
b <- read.csv("/Users/Clive/Desktop//Gmi-Gde MSAT data 11May2015_gulfPCA.csv")
ggplot(b, aes(a$Axis1, a$Axis2, label= a$pop, color=(a$sp))) + geom_text(size=3, alpha=.8, cex=4, position="jitter") + theme(panel.background = element_blank(), panel.grid.major = element_blank(), panel.grid.minor=element_blank(), axis.line = element_line(size = .3), legend.position="none") + stat_ellipse(level=.95, linetype=1) + labs(x="PCA1", y="PCA3", title="PCA of G. mirabilis (blue) and detrusus (red) in northern Gulf")
source("~/GitHub/PyRate-master/pyrate_utilities.r")
extract.ages(file="~/GitHub/PyRate-master/example_files/Ursidae.txt", replicates=10)
version
version
setwd("~/GitHub/macroevo")
mu <- 1e-4
NN <- 10000
CoalesTime <- rexp(10000, 1/(2*NN))
MutaRate <- 2*mu*CoalesTime
mean(MutaRate)
for (ii in 1:10000){
NumbSNP <- rpois(1, MutaRate[ii])
}
mean(NumbSNP)
mu <- 1e-4
NN <- 10000
CoalesTime <- rexp(10000, 1/(2*NN))
MutaRate <- 2*mu*CoalesTime
mean(MutaRate)
#NumbSNP <- rpois(10000, mean(MutaRate))
for (ii in 1:10000){
NumbSNP <- rpois(1, MutaRate[ii])
}
mean(NumbSNP)
mu <- 1e-4
NN <- 10000
CoalesTime <- rexp(10000, 1/(2*NN))
MutaRate <- 2*mu*CoalesTime
mean(MutaRate)
#NumbSNP <- rpois(10000, mean(MutaRate))
for (ii in 1:10000){
NumbSNP <- rpois(1, MutaRate[ii])
}
mean(NumbSNP)
mu <- 1e-4
NN <- 10000
CoalesTime <- rexp(10000, 1/(2*NN))
MutaRate <- 2*mu*CoalesTime
mean(MutaRate)
for (ii in 1:10000){
NumbSNP <- rpois(1, MutaRate[ii])
}
NumbSNP
NumbSNP <- rep(NA, NN)
for (ii in 1:10000){
NumbSNP[ii] <- rpois(1, MutaRate[ii])
}
mean(NumbSNP)
mu <- 1e-4
NN <- 10000
CoalesTime <- rexp(10000, 1/(2*NN))
MutaRate <- 2*mu*CoalesTime
mean(MutaRate)
NumbSNP <- rep(NA, NN)
for (ii in 1:10000){
NumbSNP[ii] <- rpois(1, MutaRate[ii])
}
mean(NumbSNP)
mu <- 1e-4
NN <- 10000
CoalesTime <- rexp(10000, 1/(2*NN))
MutaRate <- 2*mu*CoalesTime
mean(MutaRate)
NumbSNP <- rep(NA, NN)
for (ii in 1:10000){
NumbSNP[ii] <- rpois(1, MutaRate[ii])
}
mean(NumbSNP)
mu <- 1e-4
NN <- 1000
CoalesTime <- rexp(10000, 1/(2*NN))
MutaRate <- 2*mu*CoalesTime
mean(MutaRate)
NumbSNP <- rep(NA, NN)
for (ii in 1:10000){
NumbSNP[ii] <- rpois(1, MutaRate[ii])
}
mean(NumbSNP)
hist(NumbSNP)
mu <- 1e-8
NN <- 10000
CoalesTime <- rexp(10000, 1/(2*NN))
MutaRate <- 2*mu*CoalesTime
mean(MutaRate)
NumbSNP <- rep(NA, NN)
for (ii in 1:10000){
NumbSNP[ii] <- rpois(1, MutaRate[ii])
}
sum(NumbSNP >= 10)/10000
mu <- 1e-8*10000
NN <- 10000
CoalesTime <- rexp(10000, 1/(2*NN))
MutaRate <- 2*mu*CoalesTime
mean(MutaRate)
NumbSNP <- rep(NA, NN)
for (ii in 1:10000){
NumbSNP[ii] <- rpois(1, MutaRate[ii])
}
sum(NumbSNP >= 10)/10000
sum(NumbSNP >= 10)
mu <- 1e-8*10000
NN <- 10000
CoalesTime <- rexp(10000, 1/(2*NN))
MutaRate <- 2*mu*CoalesTime
mean(MutaRate)
NumbSNP <- rep(NA, NN)
for (ii in 1:10000){
NumbSNP[ii] <- rpois(1, MutaRate[ii])
}
sum(NumbSNP >= 10)
CoalesTime <- rexp(10000, 1/(2*NN))
MutaRate <- 2*mu*CoalesTime
mean(MutaRate)
NumbSNP <- rep(NA, NN)
for (ii in 1:10000){
NumbSNP[ii] <- rpois(1, MutaRate[ii])
}
sum(NumbSNP >= 10)
mu <- 1e-8*10000
NN <- 1000
CoalesTime <- rexp(10000, 1/(2*NN))
MutaRate <- 2*mu*CoalesTime
mean(MutaRate)
NumbSNP <- rep(NA, NN)
for (ii in 1:10000){
NumbSNP[ii] <- rpois(1, MutaRate[ii])
}
sum(NumbSNP >= 10)
plot(CoalesTime, NumbSNP)
hist(NumbSNP)
mu <- 1e-4
NN <- 1000
CoalesTime <- rexp(10000, 1/(2*NN))
MutaRate <- 2*mu*CoalesTime
mean(MutaRate)
NumbSNP <- rep(NA, NN)
for (ii in 1:10000){
NumbSNP[ii] <- rpois(1, MutaRate[ii])
}
plot(CoalesTime, NumbSNP)
#add mutations, 10,000 sims, 2N=2,000
mu <- 1e-4
NN <- 1000
CoalesTime <- rexp(10000, 1/(2*NN))
MutaRate <- 2*mu*CoalesTime
mean(MutaRate)
NumbSNP <- rep(NA, NN)
for (ii in 1:10000){
NumbSNP[ii] <- rpois(1, MutaRate[ii])
}
plot(CoalesTime, NumbSNP)
sum(NumbSNP >= 10)/10000
mu <- 1e-8*10000
NN <- 10000
CoalesTime <- rexp(10000, 1/(2*NN))
MutaRate <- 2*mu*CoalesTime
mean(MutaRate)
NumbSNP <- rep(NA, NN)
for (ii in 1:10000){
NumbSNP[ii] <- rpois(1, MutaRate[ii])
}
sum(NumbSNP >= 10)/10000
