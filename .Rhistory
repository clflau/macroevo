# 1 files combined:
# 	C:\Users\Tharsis\Documents\GitHub\PyRate-master\PyRate-master\example_files\pyrate_mcmc_logs/Ursidae_1_G_marginal_rates.log
# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)
pdf(file='~/GitHub/PyRate-master/PyRate-master/example_files/pyrate_mcmc_logs/Ursidae_1_G_marginal_rates_RTT.pdf',width=0.6*9, height=0.6*21)
par(mfrow=c(3,1))
library(scales)
L_hpd_m95=c(0.149, 0.149,0.15,0.149,0.149,0.15,0.15,0.146,0.143,0.138,0.131,0.131,0.128,0.128,0.128,0.127,0.128,0.126,0.123,0.09,0.102,0.168)
L_hpd_M95=c(0.325, 0.325,0.325,0.325,0.323,0.321,0.319,0.311,0.306,0.297,0.29,0.289,0.286,0.284,0.284,0.284,0.286,0.286,0.29,0.35,1.087,1.746)
M_hpd_m95=c(0.164, 0.164,0.178,0.179,0.174,0.16,0.156,0.149,0.133,0.115,0.113,0.112,0.113,0.112,0.115,0.116,0.117,0.117,0.116,0.116,0.114,0.116)
M_hpd_M95=c(0.58, 0.58,0.469,0.468,0.462,0.452,0.448,0.442,0.421,0.367,0.333,0.317,0.313,0.309,0.311,0.309,0.309,0.309,0.309,0.309,0.311,0.337)
R_hpd_m95=c(-0.371, -0.371,-0.274,-0.269,-0.26,-0.249,-0.237,-0.232,-0.21,-0.176,-0.147,-0.136,-0.134,-0.127,-0.127,-0.125,-0.125,-0.127,-0.137,-0.188,-0.175,-0.07)
R_hpd_M95=c(0.167, 0.167,0.091,0.091,0.091,0.099,0.106,0.106,0.113,0.114,0.113,0.113,0.113,0.113,0.113,0.113,0.113,0.113,0.113,0.185,0.884,1.562)
L_mean=c(0.228, 0.228,0.229,0.229,0.228,0.227,0.226,0.224,0.219,0.215,0.212,0.21,0.209,0.209,0.209,0.208,0.209,0.21,0.212,0.23,0.402,1.003)
M_mean=c(0.332, 0.332,0.302,0.297,0.287,0.28,0.272,0.264,0.249,0.23,0.22,0.216,0.215,0.214,0.214,0.214,0.214,0.215,0.214,0.215,0.215,0.227)
R_mean=c(-0.104, -0.104,-0.073,-0.068,-0.059,-0.052,-0.046,-0.04,-0.031,-0.015,-0.008,-0.006,-0.005,-0.005,-0.006,-0.006,-0.005,-0.005,-0.002,0.016,0.187,0.776)
trans=0.5
age=(0:(22-1))* -1
plot(age,age,type = 'n', ylim = c(0, 1.9206), xlim = c(-23.1,1.1), ylab = 'Speciation rate', xlab = 'Ma',main='Ursidae' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 0.638), xlim = c(-23.1,1.1), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-0.4081, 1.7182), xlim = c(-23.1,1.1), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
n <- dev.off()
par(mfrow=c(3,1))
library(scales)
L_hpd_m95=c(0.149, 0.149,0.15,0.149,0.149,0.15,0.15,0.146,0.143,0.138,0.131,0.131,0.128,0.128,0.128,0.127,0.128,0.126,0.123,0.09,0.102,0.168)
L_hpd_M95=c(0.325, 0.325,0.325,0.325,0.323,0.321,0.319,0.311,0.306,0.297,0.29,0.289,0.286,0.284,0.284,0.284,0.286,0.286,0.29,0.35,1.087,1.746)
M_hpd_m95=c(0.164, 0.164,0.178,0.179,0.174,0.16,0.156,0.149,0.133,0.115,0.113,0.112,0.113,0.112,0.115,0.116,0.117,0.117,0.116,0.116,0.114,0.116)
M_hpd_M95=c(0.58, 0.58,0.469,0.468,0.462,0.452,0.448,0.442,0.421,0.367,0.333,0.317,0.313,0.309,0.311,0.309,0.309,0.309,0.309,0.309,0.311,0.337)
R_hpd_m95=c(-0.371, -0.371,-0.274,-0.269,-0.26,-0.249,-0.237,-0.232,-0.21,-0.176,-0.147,-0.136,-0.134,-0.127,-0.127,-0.125,-0.125,-0.127,-0.137,-0.188,-0.175,-0.07)
R_hpd_M95=c(0.167, 0.167,0.091,0.091,0.091,0.099,0.106,0.106,0.113,0.114,0.113,0.113,0.113,0.113,0.113,0.113,0.113,0.113,0.113,0.185,0.884,1.562)
L_mean=c(0.228, 0.228,0.229,0.229,0.228,0.227,0.226,0.224,0.219,0.215,0.212,0.21,0.209,0.209,0.209,0.208,0.209,0.21,0.212,0.23,0.402,1.003)
M_mean=c(0.332, 0.332,0.302,0.297,0.287,0.28,0.272,0.264,0.249,0.23,0.22,0.216,0.215,0.214,0.214,0.214,0.214,0.215,0.214,0.215,0.215,0.227)
R_mean=c(-0.104, -0.104,-0.073,-0.068,-0.059,-0.052,-0.046,-0.04,-0.031,-0.015,-0.008,-0.006,-0.005,-0.005,-0.006,-0.006,-0.005,-0.005,-0.002,0.016,0.187,0.776)
trans=0.5
age=(0:(22-1))* -1
plot(age,age,type = 'n', ylim = c(0, 1.9206), xlim = c(-23.1,1.1), ylab = 'Speciation rate', xlab = 'Ma',main='Ursidae' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 0.638), xlim = c(-23.1,1.1), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-0.4081, 1.7182), xlim = c(-23.1,1.1), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
par(mfrow=c(1,1))
library(scales)
L_hpd_m95=c(0.149, 0.149,0.15,0.149,0.149,0.15,0.15,0.146,0.143,0.138,0.131,0.131,0.128,0.128,0.128,0.127,0.128,0.126,0.123,0.09,0.102,0.168)
L_hpd_M95=c(0.325, 0.325,0.325,0.325,0.323,0.321,0.319,0.311,0.306,0.297,0.29,0.289,0.286,0.284,0.284,0.284,0.286,0.286,0.29,0.35,1.087,1.746)
M_hpd_m95=c(0.164, 0.164,0.178,0.179,0.174,0.16,0.156,0.149,0.133,0.115,0.113,0.112,0.113,0.112,0.115,0.116,0.117,0.117,0.116,0.116,0.114,0.116)
M_hpd_M95=c(0.58, 0.58,0.469,0.468,0.462,0.452,0.448,0.442,0.421,0.367,0.333,0.317,0.313,0.309,0.311,0.309,0.309,0.309,0.309,0.309,0.311,0.337)
R_hpd_m95=c(-0.371, -0.371,-0.274,-0.269,-0.26,-0.249,-0.237,-0.232,-0.21,-0.176,-0.147,-0.136,-0.134,-0.127,-0.127,-0.125,-0.125,-0.127,-0.137,-0.188,-0.175,-0.07)
R_hpd_M95=c(0.167, 0.167,0.091,0.091,0.091,0.099,0.106,0.106,0.113,0.114,0.113,0.113,0.113,0.113,0.113,0.113,0.113,0.113,0.113,0.185,0.884,1.562)
L_mean=c(0.228, 0.228,0.229,0.229,0.228,0.227,0.226,0.224,0.219,0.215,0.212,0.21,0.209,0.209,0.209,0.208,0.209,0.21,0.212,0.23,0.402,1.003)
M_mean=c(0.332, 0.332,0.302,0.297,0.287,0.28,0.272,0.264,0.249,0.23,0.22,0.216,0.215,0.214,0.214,0.214,0.214,0.215,0.214,0.215,0.215,0.227)
R_mean=c(-0.104, -0.104,-0.073,-0.068,-0.059,-0.052,-0.046,-0.04,-0.031,-0.015,-0.008,-0.006,-0.005,-0.005,-0.006,-0.006,-0.005,-0.005,-0.002,0.016,0.187,0.776)
trans=0.5
age=(0:(22-1))* -1
plot(age,age,type = 'n', ylim = c(0, 1.9206), xlim = c(-23.1,1.1), ylab = 'Speciation rate', xlab = 'Ma',main='Ursidae' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
setwd("~/GitHub/macroevo")
#function
GenDriftFunc <- function(LL, NN, p0, TT){
#matrix of allele freq of each SNP (col) in each gen (row)
freqs <- matrix(nrow = TT, ncol = LL)
#fill first row with p0
freqs[1, ] <- p0
#for loop to iterate rbinom for each subsequent row
for (tt in 2:TT){
for(ll in 1:LL){
freqs[tt, ll] <- rbinom(1, 2*NN, freqs[tt-1, ll])/(2*NN)
}
}
return(freqs)
}
NN=10
LL=20
TT=30
sim2 <- GenDriftFunc(LL, NN, p0, TT)
p0=0.1
sim2 <- GenDriftFunc(LL, NN, p0, TT)
sim2
#use function
NN=100
LL=1000
TT=10000
p0=0.1
sim1 <- GenDriftFunc(L=, N, p0, T)
sim1 <- GenDriftFunc(LL, NN, p0, TT)
sum(sim1[10000, ] == 0)
sum(sim1[10000, ] == 1)
sum(sim1[10000, ] == 1)/1000
?plot
plot(sim1, type = "l")
head(sim1)
cumsum(sim1[ , 1])
sim1[ , 1]
xx <- sim1[ , 1:100]
plot(xx, type = "l")
xx <- sim1[ , 1]
plot(xx, type = "l")
plot(xx, type = "l")
for(ii in 2:100){
lines(sim1[ , ii])
}
plot(xx, type = "l", ylim = c(0, 1))
for(ii in 2:100){
lines(sim1[ , ii])
}
plot(xx, type = "l", ylim = c(0, 1), xlim = 1500)
for(ii in 2:100){
lines(sim1[ , ii])
}
plot(xx, type = "l", ylim = c(0, 1), xlim = 2000)
plot(xx, type = "l", ylim = c(0, 1), xlim = c(0, 1500)
)
for(ii in 2:100){
lines(sim1[ , ii])
}
plot(xx, type = "l", ylim = c(0, 1), xlim = c(0, 2000))
for(ii in 2:100){
lines(sim1[ , ii])
}
plot(xx, type = "l", ylim = c(0, 1), xlim = c(0, 2000), main = "N=100", xlab = "Generation", ylab = "Frequency")
for(ii in 2:100){
lines(sim1[ , ii])
}
#repeat
NN=100
LL=1000
TT=10000
p0=0.6
sim2 <- GenDriftFunc(LL, NN, p0, TT)
#extinct?
sum(sim2[10000, ] == 0)
sum(sim2[10000, ] == 1)
sum(sim2[10000, ] == 1)/1000
sum(sim1[10000, ] == 1)/1000
sum(sim1[10000, ] == 1)
sum(sim2[10000, ] == 1)/1000
#N=10
NN=10
LL=1000
TT=10000
p0=0.1
sim3 <- GenDriftFunc(LL, NN, p0, TT)
NN=500
LL=1000
TT=10000
p0=0.1
sim4 <- GenDriftFunc(LL, NN, p0, TT)
NN=500
LL=1000
TT=10000
p0=0.1
sim5 <- GenDriftFunc(LL, NN, p0, TT)
# N=1000
NN=1000
LL=1000
TT=10000
p0=0.1
sim5 <- GenDriftFunc(LL, NN, p0, TT)
xx <- sim5[ , 1]
plot(xx, type = "l", ylim = c(0, 1), xlim = c(0, 2000), main = "N=100", xlab = "Generation", ylab = "Frequency")
for(ii in 2:100){
lines(sim5[ , ii])
}
plot(xx, type = "l", ylim = c(0, 1), xlim = c(0, 10000), main = "N=100", xlab = "Generation", ylab = "Frequency")
for(ii in 2:100){
lines(sim5[ , ii])
}
xx <- sim4[ , 1]
plot(xx, type = "l", ylim = c(0, 1), xlim = c(0, 10000), main = "N=100", xlab = "Generation", ylab = "Frequency")
for(ii in 2:100){
lines(sim4[ , ii])
}
plot(sim1[ , 1], type = "l", ylim = c(0, 1), xlim = c(0, 6000), main = "N=100", xlab = "Generation", ylab = "Frequency", col = 1)
plot(sim1[ , 1], type = "l", ylim = c(0, 1), xlim = c(0, 6000), main = "N=100", xlab = "Generation", ylab = "Frequency", col = 2)
for(ii in 2:100){
lines(sim1[ , ii], col = 2)
}
#plot sim1, sim3, sim4, sim5
plot(sim1[ , 1], type = "l", ylim = c(0, 1), xlim = c(0, 6000), main = "N=100", xlab = "Generation", ylab = "Frequency", col = 2)
for(ii in 2:100){
lines(sim1[ , ii], col = 2)
}
for(ii in 1:100){
lines(sim3[ , ii], col = 3)
}
for(ii in 1:100){
lines(sim4[ , ii], col = 4)
}
for(ii in 1:100){
lines(sim5[ , ii], col = 5)
}
plot(sim1[ , 1], type = "l", ylim = c(0, 1), xlim = c(0, 6000), main = "N=100", xlab = "Generation", ylab = "Frequency", col = 2, lwd = 0.5)
plot(sim1[ , 1], type = "l", ylim = c(0, 1), xlim = c(0, 6000), main = "N=100", xlab = "Generation", ylab = "Frequency", col = 2, lwd = 0.1)
lines(sim1[ , ii], col = 2, lwd = 0.1)
for(ii in 2:100){
lines(sim1[ , ii], col = 2, lwd = 0.1)
}
plot(sim1[ , 1], type = "l", ylim = c(0, 1), xlim = c(0, 6000), main = "N=100", xlab = "Generation", ylab = "Frequency", col = 2, lwd = 0.1)
for(ii in 2:100){
lines(sim1[ , ii], col = 2, lwd = 0.01)
}
plot(sim1[ , 1], type = "l", ylim = c(0, 1), xlim = c(0, 6000), main = "N=100", xlab = "Generation", ylab = "Frequency", col = 2, lwd = 0.1)
for(ii in 2:100){
lines(sim1[ , ii], col = 2, lwd = 0.01)
}
for(ii in 1:100){
lines(sim3[ , ii], col = 3, lwd = 0.01)
}
for(ii in 1:100){
lines(sim4[ , ii], col = 4, lwd = 0.01)
}
for(ii in 1:100){
lines(sim5[ , ii], col = 5, lwd = 0.01)
}
?palette
?'lty'
lines(sim1[ , ii], col = 2, lwd = 0.01, alpha = 0.3)
for(ii in 2:100){
lines(sim1[ , ii], col = 2, lwd = 0.01)
adjustcolor(alpha.f = 0.3)
}
lines(sim1[ , ii], col = 2, lwd = 0.01)
adjustcolor(col = 2, alpha.f = 0.3)
plot(sim1[ , 1], type = "l", ylim = c(0, 1), xlim = c(0, 6000), main = "N=100", xlab = "Generation", ylab = "Frequency", col = 2, lwd = 0.1)
for(ii in 2:100){
lines(sim1[ , ii], col = 2, lwd = 0.01)
adjustcolor(col = 2, alpha.f = 0.3)
}
plot(sim1[ , 1], type = "l", ylim = c(0, 1), xlim = c(0, 6000), main = "N=100", xlab = "Generation", ylab = "Frequency", col = 2, lwd = 0.1)
for(ii in 2:100){
lines(sim1[ , ii], col = 2, lwd = 0.01)
adjustcolor(col = 2, alpha.f = 0.1)
}
for(ii in 1:100){
lines(sim4[ , ii], col = 4, lwd = 0.01)
adjustcolor(col = 4, alpha.f = 0.1)
}
for(ii in 2:100){
lines(sim1[ , ii], col = 2, lwd = 0.01)
adjustcolor(col = 2, alpha.f = 0.01)
}
for(ii in 1:100){
lines(sim4[ , ii], col = 4, lwd = 0.01)
adjustcolor(col = 4, alpha.f = 0.01)
}
for(ii in 2:100){
lines(sim1[ , ii], col = 2, lwd = 0.01)
adjustcolor(col = 2, alpha.f = 0.9)
}
for(ii in 1:100){
lines(sim4[ , ii], col = 4, lwd = 0.01)
adjustcolor(col = 4, alpha.f = 0.9)
}
plot(sim1[ , 1], type = "l", ylim = c(0, 1), xlim = c(0, 6000), main = "N=100", xlab = "Generation", ylab = "Frequency", col = 2, lwd = 0.1)
for(ii in 2:100){
lines(sim1[ , ii], col = 2, lwd = 0.01)
adjustcolor(col = 2, alpha.f = 0.7)
}
for(ii in 1:100){
lines(sim3[ , ii], col = 3, lwd = 0.01)
adjustcolor(col = 3, alpha.f = 0.9)
}
for(ii in 1:100){
lines(sim4[ , ii], col = 4, lwd = 0.01)
adjustcolor(col = 4, alpha.f = 0.3)
}
for(ii in 1:100){
lines(sim5[ , ii], col = 5, lwd = 0.01)
adjustcolor(col = 5, alpha.f = 0.1)
}
plot(sim1[ , 1], type = "l", ylim = c(0, 1), xlim = c(0, 2000), main = "N=100", xlab = "Generation", ylab = "Frequency")
for(ii in 2:100){
lines(sim1[ , ii])
}
fix1 <- sum(sim1[10000, ] == 1)/1000
fix3 <- sum(sim3[10000, ] == 1)/1000
fix4 <- sum(sim4[10000, ] == 1)/1000
fix5 <- sum(sim5[10000, ] == 1)/1000
fixAll <- c(fix1, fix3, fix4, fix5)
fixAll
?cbind
table <- rbind(popsize, fixAll)
table <- rbind(popsize, fixAll)
popsize <- c(10, 100, 500, 1000)
fixAll <- c(fix3, fix1, fix4, fix5)
table <- rbind(popsize, fixAll)
table
fixedproportion <- c(fix3, fix1, fix4, fix5)
table <- rbind(popsize, fixedproportion)
table
